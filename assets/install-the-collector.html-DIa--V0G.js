import{_ as c}from"./plugin-vue_export-helper-DlAUqK2U.js";import{r,o as p,c as d,e as o,w as a,a as e,d as i,b as n}from"./app-DbRsw7jK.js";const u={},m=e("div",{class:"hint-container tip"},[e("p",{class:"hint-container-title"},"✨✨✨✨✨"),e("p",null,"您可以将OpenTelemetry收集器部署在各种操作系统和架构上。以下说明显示了如何下载并安装最新稳定版本的收集器。"),e("p",null,"如果您不熟悉适用于OpenTelemetry收集器的部署模型、组件和仓库，首先请查看数据收集和部署方法页面。")],-1),h=e("h2",{id:"docker",tabindex:"-1"},[e("a",{class:"header-anchor",href:"#docker"},[e("span",null,"Docker")])],-1),b=e("p",null,"以下命令拉取Docker镜像并在容器中运行收集器。将0.104.0替换为您要运行的收集器版本。",-1),v=e("div",{class:"language-bash line-numbers-mode","data-ext":"sh","data-title":"sh"},[e("pre",{class:"language-bash"},[e("code",null,[e("span",{class:"token function"},"docker"),n(` pull otel/opentelemetry-collector-contrib:0.104.0
`),e("span",{class:"token function"},"docker"),n(` run otel/opentelemetry-collector-contrib:0.104.0
`)])]),e("div",{class:"line-numbers","aria-hidden":"true"},[e("div",{class:"line-number"}),e("div",{class:"line-number"})])],-1),k=e("p",null,"若要从工作目录加载自定义配置文件，请将该文件作为卷挂载：",-1),g=e("div",{class:"language-bash line-numbers-mode","data-ext":"sh","data-title":"sh"},[e("pre",{class:"language-bash"},[e("code",null,[e("span",{class:"token function"},"docker"),n(" run "),e("span",{class:"token parameter variable"},"-v"),n(),e("span",{class:"token variable"},[e("span",{class:"token variable"},"$("),e("span",{class:"token builtin class-name"},"pwd"),e("span",{class:"token variable"},")")]),n(`/config.yaml:/etc/otelcol-contrib/config.yaml otel/opentelemetry-collector-contrib:0.104.0
`)])]),e("div",{class:"line-numbers","aria-hidden":"true"},[e("div",{class:"line-number"})])],-1),_=i(`<h2 id="docker-compose" tabindex="-1"><a class="header-anchor" href="#docker-compose"><span>Docker Compose</span></a></h2><p>您可以在现有的docker-compose.yaml文件中添加OpenTelemetry收集器，例如：</p><div class="language-yaml line-numbers-mode" data-ext="yml" data-title="yml"><pre class="language-yaml"><code><span class="token key atrule">otel-collector</span><span class="token punctuation">:</span>
  <span class="token key atrule">image</span><span class="token punctuation">:</span> otel/opentelemetry<span class="token punctuation">-</span>collector<span class="token punctuation">-</span>contrib
  <span class="token key atrule">volumes</span><span class="token punctuation">:</span>
    <span class="token punctuation">-</span> ./otel<span class="token punctuation">-</span>collector<span class="token punctuation">-</span>config.yaml<span class="token punctuation">:</span>/etc/otelcol<span class="token punctuation">-</span>contrib/config.yaml
  <span class="token key atrule">ports</span><span class="token punctuation">:</span>
    <span class="token punctuation">-</span> 1888<span class="token punctuation">:</span><span class="token number">1888</span> <span class="token comment"># pprof扩展</span>
    <span class="token punctuation">-</span> 8888<span class="token punctuation">:</span><span class="token number">8888</span> <span class="token comment"># Collector暴露的Prometheus指标</span>
    <span class="token punctuation">-</span> 8889<span class="token punctuation">:</span><span class="token number">8889</span> <span class="token comment"># Prometheus导出器指标</span>
    <span class="token punctuation">-</span> 13133<span class="token punctuation">:</span><span class="token number">13133</span> <span class="token comment"># health_check扩展</span>
    <span class="token punctuation">-</span> 4317<span class="token punctuation">:</span><span class="token number">4317</span> <span class="token comment"># OTLP gRPC接收器</span>
    <span class="token punctuation">-</span> 4318<span class="token punctuation">:</span><span class="token number">4318</span> <span class="token comment"># OTLP http接收器</span>
    <span class="token punctuation">-</span> 55679<span class="token punctuation">:</span><span class="token number">55679</span> <span class="token comment"># zpages扩展</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h2 id="kubernetes" tabindex="-1"><a class="header-anchor" href="#kubernetes"><span>Kubernetes</span></a></h2><p>以下命令部署一个作为 daemonset 和一个单一网关实例的代理：</p><div class="language-bash line-numbers-mode" data-ext="sh" data-title="sh"><pre class="language-bash"><code>kubectl apply <span class="token parameter variable">-f</span> https://raw.githubusercontent.com/open-telemetry/opentelemetry-collector/v0.104.0/examples/k8s/otel-config.yaml
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><p>此示例旨在作为起点，在实际生产使用前需要进行扩展和自定义。对于生产就绪的自定义和安装，请参阅 OpenTelemetry Helm 图表。</p><p>您还可以使用 OpenTelemetry Operator 来管理和维护 OpenTelemetry 收集器实例，具有自动升级处理、基于 OpenTelemetry 配置的 Service 配置、自动将 sidecar 注入部署等功能。</p><p>有关如何使用收集器与 Kubernetes 的指南，请参阅 Kubernetes 入门。</p><h2 id="nomad" tabindex="-1"><a class="header-anchor" href="#nomad"><span>Nomad</span></a></h2><p>您可以在 HashiCorp Nomad 上的 Getting Started with OpenTelemetry 找到参考作业文件，以将收集器作为agent、gateway和全功能示例部署。</p><h2 id="linux" tabindex="-1"><a class="header-anchor" href="#linux"><span>Linux</span></a></h2><p>每个收集器发布版本都包括针对 Linux amd64/arm64/i386 系统的 APK、DEB 和 RPM 打包。安装后，您可以在 /etc/otelcol/config.yaml 中找到默认配置。</p><div class="hint-container tip"><p class="hint-container-title">提示</p><p>systemd 是自动服务配置所必需的。</p></div><h2 id="apk安装" tabindex="-1"><a class="header-anchor" href="#apk安装"><span>APK安装</span></a></h2><p>要在Alpine系统上开始使用，请运行以下命令：</p>`,16),y=e("div",{class:"language-bash line-numbers-mode","data-ext":"sh","data-title":"sh"},[e("pre",{class:"language-bash"},[e("code",null,[n(`apk update
apk `),e("span",{class:"token function"},"add"),n(),e("span",{class:"token function"},"wget"),n(` shadow
`),e("span",{class:"token function"},"wget"),n(` https://github.com/open-telemetry/opentelemetry-collector-releases/releases/download/v0.104.0/otelcol_0.104.0_linux_amd64.apk
apk `),e("span",{class:"token function"},"add"),n(` --allow-untrusted otelcol_0.104.0_linux_amd64.apk
`)])]),e("div",{class:"line-numbers","aria-hidden":"true"},[e("div",{class:"line-number"}),e("div",{class:"line-number"}),e("div",{class:"line-number"}),e("div",{class:"line-number"})])],-1),f=e("h2",{id:"deb安装",tabindex:"-1"},[e("a",{class:"header-anchor",href:"#deb安装"},[e("span",null,"DEB安装")])],-1),x=e("p",null,"要在Debian系统上开始使用，请运行以下命令：",-1),w=e("div",{class:"language-bash line-numbers-mode","data-ext":"sh","data-title":"sh"},[e("pre",{class:"language-bash"},[e("code",null,[e("span",{class:"token function"},"sudo"),n(),e("span",{class:"token function"},"apt-get"),n(` update
`),e("span",{class:"token function"},"sudo"),n(),e("span",{class:"token function"},"apt-get"),n(),e("span",{class:"token parameter variable"},"-y"),n(),e("span",{class:"token function"},"install"),n(),e("span",{class:"token function"},"wget"),n(` systemctl
`),e("span",{class:"token function"},"wget"),n(` https://github.com/open-telemetry/opentelemetry-collector-releases/releases/download/v0.104.0/otelcol_0.104.0_linux_amd64.deb
`),e("span",{class:"token function"},"sudo"),n(" dpkg "),e("span",{class:"token parameter variable"},"-i"),n(` otelcol_0.104.0_linux_amd64.deb
`)])]),e("div",{class:"line-numbers","aria-hidden":"true"},[e("div",{class:"line-number"}),e("div",{class:"line-number"}),e("div",{class:"line-number"}),e("div",{class:"line-number"})])],-1),T=e("h2",{id:"rpm安装",tabindex:"-1"},[e("a",{class:"header-anchor",href:"#rpm安装"},[e("span",null,"RPM安装")])],-1),O=e("p",null,"要在Red Hat系统上开始使用，请运行以下命令：",-1),A=e("div",{class:"language-bash line-numbers-mode","data-ext":"sh","data-title":"sh"},[e("pre",{class:"language-bash"},[e("code",null,[e("span",{class:"token function"},"sudo"),n(` yum update
`),e("span",{class:"token function"},"sudo"),n(" yum "),e("span",{class:"token parameter variable"},"-y"),n(),e("span",{class:"token function"},"install"),n(),e("span",{class:"token function"},"wget"),n(` systemctl
`),e("span",{class:"token function"},"wget"),n(` https://github.com/open-telemetry/opentelemetry-collector-releases/releases/download/v0.104.0/otelcol_0.104.0_linux_amd64.rpm
`),e("span",{class:"token function"},"sudo"),n(),e("span",{class:"token function"},"rpm"),n(),e("span",{class:"token parameter variable"},"-ivh"),n(` otelcol_0.104.0_linux_amd64.rpm
`)])]),e("div",{class:"line-numbers","aria-hidden":"true"},[e("div",{class:"line-number"}),e("div",{class:"line-number"}),e("div",{class:"line-number"}),e("div",{class:"line-number"})])],-1),D=i(`<h2 id="手动linux安装" tabindex="-1"><a class="header-anchor" href="#手动linux安装"><span>手动Linux安装</span></a></h2><p>Linux发布版本适用于各种架构。您可以下载包含二进制文件的文件，并在您的机器上手动安装：</p><div class="language-bash line-numbers-mode" data-ext="sh" data-title="sh"><pre class="language-bash"><code><span class="token function">curl</span> <span class="token parameter variable">--proto</span> <span class="token string">&#39;=https&#39;</span> <span class="token parameter variable">--tlsv1.2</span> <span class="token parameter variable">-fOL</span> https://github.com/open-telemetry/opentelemetry-collector-releases/releases/download/v0.104.0/otelcol_0.104.0_linux_amd64.tar.gz
<span class="token function">tar</span> <span class="token parameter variable">-xvf</span> otelcol_0.104.0_linux_amd64.tar.gz
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div></div></div><h2 id="自动服务配置" tabindex="-1"><a class="header-anchor" href="#自动服务配置"><span>自动服务配置</span></a></h2><p>默认情况下，安装后，otelcol systemd服务会使用--config=/etc/otelcol/config.yaml选项启动。</p><p>要使用不同的设置，请在/etc/otelcol/otelcol.conf系统d环境文件中设置OTELCOL_OPTIONS变量，以适当的命令行选项。您可以运行/usr/bin/otelcol --help来查看所有可用的选项。您可以通过向此文件添加它们，向otelcol服务传递额外的环境变量。</p><p>如果您修改了收集器配置文件或/etc/otelcol/otelcol.conf，请运行以下命令重启otelcol服务以应用更改：</p><div class="language-bash line-numbers-mode" data-ext="sh" data-title="sh"><pre class="language-bash"><code><span class="token function">sudo</span> systemctl restart otelcol
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><p>要检查otelcol服务的输出，请运行：</p><div class="language-bash line-numbers-mode" data-ext="sh" data-title="sh"><pre class="language-bash"><code><span class="token function">sudo</span> journalctl <span class="token parameter variable">-u</span> otelcol
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><h2 id="macos" tabindex="-1"><a class="header-anchor" href="#macos"><span>macOS</span></a></h2><p>macOS发布版本适用于Intel和ARM系统。发布版本打包为gzipped tarball (.tar.gz)。解压后，每个收集器发布版本都包含一个otelcol可执行文件。</p><h2 id="windows" tabindex="-1"><a class="header-anchor" href="#windows"><span>Windows</span></a></h2><p>Windows发布版本打包为gzipped tarball (.tar.gz)。每个收集器发布版本都包含一个otelcol.exe可执行文件。</p><h2 id="从源代码构建" tabindex="-1"><a class="header-anchor" href="#从源代码构建"><span>从源代码构建</span></a></h2><p>您可以使用以下命令基于本地操作系统构建最新版本的收集器：</p><div class="language-bash line-numbers-mode" data-ext="sh" data-title="sh"><pre class="language-bash"><code><span class="token function">git</span> clone https://github.com/open-telemetry/opentelemetry-collector.git
<span class="token builtin class-name">cd</span> opentelemetry-collector
<span class="token function">make</span> install-tools
<span class="token function">make</span> otelcorecol
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div>`,17);function C(P,N){const l=r("Tabs");return p(),d("div",null,[m,h,b,o(l,{id:"15",data:[{id:"DockerHub"}],active:0},{title0:a(({value:s,isActive:t})=>[n("DockerHub")]),tab0:a(({value:s,isActive:t})=>[v]),_:1}),k,o(l,{id:"23",data:[{id:"DockerHub"}],active:0},{title0:a(({value:s,isActive:t})=>[n("DockerHub")]),tab0:a(({value:s,isActive:t})=>[g]),_:1}),_,o(l,{id:"74",data:[{id:"AMD64"}],active:0},{title0:a(({value:s,isActive:t})=>[n("AMD64")]),tab0:a(({value:s,isActive:t})=>[y]),_:1}),f,x,o(l,{id:"85",data:[{id:"AMD64"}],active:0},{title0:a(({value:s,isActive:t})=>[n("AMD64")]),tab0:a(({value:s,isActive:t})=>[w]),_:1}),T,O,o(l,{id:"96",data:[{id:"AMD64"}],active:0},{title0:a(({value:s,isActive:t})=>[n("AMD64")]),tab0:a(({value:s,isActive:t})=>[A]),_:1}),D])}const S=c(u,[["render",C],["__file","install-the-collector.html.vue"]]),z=JSON.parse('{"path":"/articles/distributed-middleware/opentelemetry/collector/install-the-collector.html","title":"安装 Collector","lang":"zh-CN","frontmatter":{"title":"安装 Collector","date":"2024-07-04T00:00:00.000Z","order":2,"category":["分布式中间件"],"description":"✨✨✨✨✨ 您可以将OpenTelemetry收集器部署在各种操作系统和架构上。以下说明显示了如何下载并安装最新稳定版本的收集器。 如果您不熟悉适用于OpenTelemetry收集器的部署模型、组件和仓库，首先请查看数据收集和部署方法页面。","head":[["meta",{"property":"og:url","content":"http://blog.goodsxx.cn/articles/distributed-middleware/opentelemetry/collector/install-the-collector.html"}],["meta",{"property":"og:site_name","content":"Growing Notes"}],["meta",{"property":"og:title","content":"安装 Collector"}],["meta",{"property":"og:description","content":"✨✨✨✨✨ 您可以将OpenTelemetry收集器部署在各种操作系统和架构上。以下说明显示了如何下载并安装最新稳定版本的收集器。 如果您不熟悉适用于OpenTelemetry收集器的部署模型、组件和仓库，首先请查看数据收集和部署方法页面。"}],["meta",{"property":"og:type","content":"article"}],["meta",{"property":"og:locale","content":"zh-CN"}],["meta",{"property":"og:updated_time","content":"2024-07-04T08:55:13.000Z"}],["meta",{"property":"article:author","content":"SongXinXin"}],["meta",{"property":"article:published_time","content":"2024-07-04T00:00:00.000Z"}],["meta",{"property":"article:modified_time","content":"2024-07-04T08:55:13.000Z"}],["script",{"type":"application/ld+json"},"{\\"@context\\":\\"https://schema.org\\",\\"@type\\":\\"Article\\",\\"headline\\":\\"安装 Collector\\",\\"image\\":[\\"\\"],\\"datePublished\\":\\"2024-07-04T00:00:00.000Z\\",\\"dateModified\\":\\"2024-07-04T08:55:13.000Z\\",\\"author\\":[{\\"@type\\":\\"Person\\",\\"name\\":\\"SongXinXin\\"}]}"]]},"headers":[{"level":2,"title":"Docker","slug":"docker","link":"#docker","children":[]},{"level":2,"title":"Docker Compose","slug":"docker-compose","link":"#docker-compose","children":[]},{"level":2,"title":"Kubernetes","slug":"kubernetes","link":"#kubernetes","children":[]},{"level":2,"title":"Nomad","slug":"nomad","link":"#nomad","children":[]},{"level":2,"title":"Linux","slug":"linux","link":"#linux","children":[]},{"level":2,"title":"APK安装","slug":"apk安装","link":"#apk安装","children":[]},{"level":2,"title":"DEB安装","slug":"deb安装","link":"#deb安装","children":[]},{"level":2,"title":"RPM安装","slug":"rpm安装","link":"#rpm安装","children":[]},{"level":2,"title":"手动Linux安装","slug":"手动linux安装","link":"#手动linux安装","children":[]},{"level":2,"title":"自动服务配置","slug":"自动服务配置","link":"#自动服务配置","children":[]},{"level":2,"title":"macOS","slug":"macos","link":"#macos","children":[]},{"level":2,"title":"Windows","slug":"windows","link":"#windows","children":[]},{"level":2,"title":"从源代码构建","slug":"从源代码构建","link":"#从源代码构建","children":[]}],"git":{"createdTime":1720083313000,"updatedTime":1720083313000,"contributors":[{"name":"SongXinXin","email":"1368084801@qq.com","commits":1}]},"readingTime":{"minutes":3.31,"words":993},"filePathRelative":"articles/distributed-middleware/opentelemetry/collector/install-the-collector.md","localizedDate":"2024年7月4日","excerpt":"<div class=\\"hint-container tip\\">\\n<p class=\\"hint-container-title\\">✨✨✨✨✨</p>\\n<p>您可以将OpenTelemetry收集器部署在各种操作系统和架构上。以下说明显示了如何下载并安装最新稳定版本的收集器。</p>\\n<p>如果您不熟悉适用于OpenTelemetry收集器的部署模型、组件和仓库，首先请查看数据收集和部署方法页面。</p>\\n</div>\\n","autoDesc":true}');export{S as comp,z as data};
