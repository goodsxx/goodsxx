import{_ as l}from"./plugin-vue_export-helper-c27b6911.js";import{r as u,o as p,c as i,a as k,e as o,w as a,b as n,f as r,d as s}from"./app-203f50af.js";const m="/assets/1678775676522-c48ddbf0.png",d={},b=n("div",{class:"hint-container tip"},[n("p",{class:"hint-container-title"},"✨✨✨✨✨"),n("p",null,"发布/订阅模式（Publish-Subscribe Model）是 RabbitMQ 中常见的消息模式之一，它允许多个消费者接收同一个消息，每个消费者都会获得该消息的副本。在这种模式下，生产者只需将消息发送到交换机，由交换机将消息传递给所有订阅了该交换机的队列。因此，这种模式也被称为广播模式。")],-1),v=r('<h2 id="介绍" tabindex="-1"><a class="header-anchor" href="#介绍" aria-hidden="true">#</a> 介绍</h2><p>发布/订阅模式（Publish-Subscribe Model）是 RabbitMQ 中常见的消息模式之一，它允许多个消费者接收同一个消息，每个消费者都会获得该消息的副本。在这种模式下，生产者只需将消息发送到交换机，由交换机将消息传递给所有订阅了该交换机的队列。因此，这种模式也被称为广播模式。</p><figure><img src="'+m+'" alt="发布订阅" tabindex="0" loading="lazy"><figcaption>发布订阅</figcaption></figure><h2 id="交换机" tabindex="-1"><a class="header-anchor" href="#交换机" aria-hidden="true">#</a> 交换机</h2><p>交换机是 RabbitMQ 中一个非常重要的概念，它负责接收从生产者发来的消息，并将消息路由到相应的队列中。RabbitMQ 定义了多种类型的交换机，如下所示：</p><ul><li><strong>Direct Exchange</strong>：直连式交换机，根据消息的 Routing Key 直接匹配到相应的队列。</li><li><strong>Fanout Exchange</strong>：扇形交换机，将消息广播到绑定到这个交换机上的所有队列。</li><li><strong>Topic Exchange</strong>：主题交换机，根据消息的 Routing Key 进行匹配，可以支持通配符。</li><li><strong>Headers Exchange</strong>：头交换机，使用消息头部的键值对进行匹配。</li></ul><p>在发布/订阅模式中，我们通常会使用 Fanout Exchange 进行消息的广播。</p><h2 id="使用场景" tabindex="-1"><a class="header-anchor" href="#使用场景" aria-hidden="true">#</a> 使用场景</h2><p>发布/订阅模式适用于需要将消息广播给多个消费者的场景，例如新闻订阅、日志记录等。</p><h2 id="代码示例" tabindex="-1"><a class="header-anchor" href="#代码示例" aria-hidden="true">#</a> 代码示例</h2>',10),g=n("div",{class:"language-csharp line-numbers-mode","data-ext":"cs"},[n("pre",{class:"language-csharp"},[n("code",null,[n("span",{class:"token keyword"},"using"),s(),n("span",{class:"token namespace"},[s("RabbitMQ"),n("span",{class:"token punctuation"},"."),s("Client")]),n("span",{class:"token punctuation"},";"),s(`
`),n("span",{class:"token keyword"},"using"),s(),n("span",{class:"token namespace"},[s("System"),n("span",{class:"token punctuation"},"."),s("Text")]),n("span",{class:"token punctuation"},";"),s(`

`),n("span",{class:"token comment"},"// 创建连接工厂对象，指定主机名和登录凭据信息"),s(`
`),n("span",{class:"token class-name"},"ConnectionFactory"),s(" factory "),n("span",{class:"token operator"},"="),s(),n("span",{class:"token keyword"},"new"),n("span",{class:"token punctuation"},"("),n("span",{class:"token punctuation"},")"),s(`
`),n("span",{class:"token punctuation"},"{"),s(`
    HostName `),n("span",{class:"token operator"},"="),s(),n("span",{class:"token string"},'"192.168.3.100"'),n("span",{class:"token punctuation"},","),s(`
    Port `),n("span",{class:"token operator"},"="),s(),n("span",{class:"token number"},"5672"),n("span",{class:"token punctuation"},","),s(`
    UserName `),n("span",{class:"token operator"},"="),s(),n("span",{class:"token string"},'"guest"'),n("span",{class:"token punctuation"},","),s(`
    Password `),n("span",{class:"token operator"},"="),s(),n("span",{class:"token string"},'"guest"'),s(`
`),n("span",{class:"token punctuation"},"}"),n("span",{class:"token punctuation"},";"),s(`

`),n("span",{class:"token comment"},"// 创建连接和通道"),s(`
`),n("span",{class:"token keyword"},"using"),s(),n("span",{class:"token class-name"},[n("span",{class:"token keyword"},"var")]),s(" connection "),n("span",{class:"token operator"},"="),s(" factory"),n("span",{class:"token punctuation"},"."),n("span",{class:"token function"},"CreateConnection"),n("span",{class:"token punctuation"},"("),n("span",{class:"token punctuation"},")"),n("span",{class:"token punctuation"},";"),s(`
`),n("span",{class:"token keyword"},"using"),s(),n("span",{class:"token class-name"},[n("span",{class:"token keyword"},"var")]),s(" channel "),n("span",{class:"token operator"},"="),s(" connection"),n("span",{class:"token punctuation"},"."),n("span",{class:"token function"},"CreateModel"),n("span",{class:"token punctuation"},"("),n("span",{class:"token punctuation"},")"),n("span",{class:"token punctuation"},";"),s(`

`),n("span",{class:"token comment"},"// 声明交换机，指定交换机类型为 fanout"),s(`
channel`),n("span",{class:"token punctuation"},"."),n("span",{class:"token function"},"ExchangeDeclare"),n("span",{class:"token punctuation"},"("),s(`
    `),n("span",{class:"token named-parameter punctuation"},"exchange"),n("span",{class:"token punctuation"},":"),s(),n("span",{class:"token string"},'"logs"'),n("span",{class:"token punctuation"},","),s(`
    `),n("span",{class:"token named-parameter punctuation"},"type"),n("span",{class:"token punctuation"},":"),s(" ExchangeType"),n("span",{class:"token punctuation"},"."),s("Fanout"),n("span",{class:"token punctuation"},")"),n("span",{class:"token punctuation"},";"),s(`

`),n("span",{class:"token comment"},"// 发送消息到交换机"),s(`
`),n("span",{class:"token keyword"},"for"),s(),n("span",{class:"token punctuation"},"("),n("span",{class:"token class-name"},[n("span",{class:"token keyword"},"int")]),s(" i "),n("span",{class:"token operator"},"="),s(),n("span",{class:"token number"},"0"),n("span",{class:"token punctuation"},";"),s(" i "),n("span",{class:"token operator"},"<"),s(),n("span",{class:"token number"},"10"),n("span",{class:"token punctuation"},";"),s(" i"),n("span",{class:"token operator"},"++"),n("span",{class:"token punctuation"},")"),s(`
`),n("span",{class:"token punctuation"},"{"),s(`
    `),n("span",{class:"token class-name"},[n("span",{class:"token keyword"},"string")]),s(" message "),n("span",{class:"token operator"},"="),s(),n("span",{class:"token interpolation-string"},[n("span",{class:"token string"},'$"Log 消息 '),n("span",{class:"token interpolation"},[n("span",{class:"token punctuation"},"{"),n("span",{class:"token expression language-csharp"},"i"),n("span",{class:"token punctuation"},"}")]),n("span",{class:"token string"},'"')]),n("span",{class:"token punctuation"},";"),s(`
    `),n("span",{class:"token class-name"},[n("span",{class:"token keyword"},"byte"),n("span",{class:"token punctuation"},"["),n("span",{class:"token punctuation"},"]")]),s(" body "),n("span",{class:"token operator"},"="),s(" Encoding"),n("span",{class:"token punctuation"},"."),s("UTF8"),n("span",{class:"token punctuation"},"."),n("span",{class:"token function"},"GetBytes"),n("span",{class:"token punctuation"},"("),s("message"),n("span",{class:"token punctuation"},")"),n("span",{class:"token punctuation"},";"),s(`

    channel`),n("span",{class:"token punctuation"},"."),n("span",{class:"token function"},"BasicPublish"),n("span",{class:"token punctuation"},"("),s(`
        `),n("span",{class:"token named-parameter punctuation"},"exchange"),n("span",{class:"token punctuation"},":"),s(),n("span",{class:"token string"},'"logs"'),n("span",{class:"token punctuation"},","),s(),n("span",{class:"token comment"},"// 指定交换机名称"),s(`
        routingKey`),n("span",{class:"token punctuation"},":"),s(),n("span",{class:"token keyword"},"string"),n("span",{class:"token punctuation"},"."),s("Empty"),n("span",{class:"token punctuation"},","),s(),n("span",{class:"token comment"},"// 发送到 fanout 类型的交换机时，routingKey 不起作用，可以设置为空字符串"),s(`
        basicProperties`),n("span",{class:"token punctuation"},":"),s(),n("span",{class:"token keyword"},"null"),n("span",{class:"token punctuation"},","),s(`
        `),n("span",{class:"token named-parameter punctuation"},"body"),n("span",{class:"token punctuation"},":"),s(" body"),n("span",{class:"token punctuation"},")"),n("span",{class:"token punctuation"},";"),s(`

    Console`),n("span",{class:"token punctuation"},"."),n("span",{class:"token function"},"WriteLine"),n("span",{class:"token punctuation"},"("),n("span",{class:"token string"},'" [生产者] 发送消息：{0}"'),n("span",{class:"token punctuation"},","),s(" message"),n("span",{class:"token punctuation"},")"),n("span",{class:"token punctuation"},";"),s(`
`),n("span",{class:"token punctuation"},"}"),s(`

Console`),n("span",{class:"token punctuation"},"."),n("span",{class:"token function"},"WriteLine"),n("span",{class:"token punctuation"},"("),n("span",{class:"token string"},'"按[Enter]键退出"'),n("span",{class:"token punctuation"},")"),n("span",{class:"token punctuation"},";"),s(`
Console`),n("span",{class:"token punctuation"},"."),n("span",{class:"token function"},"ReadLine"),n("span",{class:"token punctuation"},"("),n("span",{class:"token punctuation"},")"),n("span",{class:"token punctuation"},";"),s(`
`)])]),n("div",{class:"line-numbers","aria-hidden":"true"},[n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"})])],-1),h=n("div",{class:"language-csharp line-numbers-mode","data-ext":"cs"},[n("pre",{class:"language-csharp"},[n("code",null,[n("span",{class:"token keyword"},"using"),s(),n("span",{class:"token namespace"},[s("RabbitMQ"),n("span",{class:"token punctuation"},"."),s("Client"),n("span",{class:"token punctuation"},"."),s("Events")]),n("span",{class:"token punctuation"},";"),s(`
`),n("span",{class:"token keyword"},"using"),s(),n("span",{class:"token namespace"},[s("RabbitMQ"),n("span",{class:"token punctuation"},"."),s("Client")]),n("span",{class:"token punctuation"},";"),s(`
`),n("span",{class:"token keyword"},"using"),s(),n("span",{class:"token namespace"},[s("System"),n("span",{class:"token punctuation"},"."),s("Text")]),n("span",{class:"token punctuation"},";"),s(`

`),n("span",{class:"token comment"},"// 创建连接工厂对象，指定主机名和登录凭据信息"),s(`
`),n("span",{class:"token class-name"},"ConnectionFactory"),s(" factory "),n("span",{class:"token operator"},"="),s(),n("span",{class:"token keyword"},"new"),n("span",{class:"token punctuation"},"("),n("span",{class:"token punctuation"},")"),s(`
`),n("span",{class:"token punctuation"},"{"),s(`
    HostName `),n("span",{class:"token operator"},"="),s(),n("span",{class:"token string"},'"192.168.3.100"'),n("span",{class:"token punctuation"},","),s(`
    Port `),n("span",{class:"token operator"},"="),s(),n("span",{class:"token number"},"5672"),n("span",{class:"token punctuation"},","),s(`
    UserName `),n("span",{class:"token operator"},"="),s(),n("span",{class:"token string"},'"guest"'),n("span",{class:"token punctuation"},","),s(`
    Password `),n("span",{class:"token operator"},"="),s(),n("span",{class:"token string"},'"guest"'),s(`
`),n("span",{class:"token punctuation"},"}"),n("span",{class:"token punctuation"},";"),s(`
`),n("span",{class:"token comment"},"// 创建连接和通道"),s(`
`),n("span",{class:"token keyword"},"using"),s(),n("span",{class:"token class-name"},[n("span",{class:"token keyword"},"var")]),s(" connection "),n("span",{class:"token operator"},"="),s(" factory"),n("span",{class:"token punctuation"},"."),n("span",{class:"token function"},"CreateConnection"),n("span",{class:"token punctuation"},"("),n("span",{class:"token punctuation"},")"),n("span",{class:"token punctuation"},";"),s(`
`),n("span",{class:"token keyword"},"using"),s(),n("span",{class:"token class-name"},[n("span",{class:"token keyword"},"var")]),s(" channel "),n("span",{class:"token operator"},"="),s(" connection"),n("span",{class:"token punctuation"},"."),n("span",{class:"token function"},"CreateModel"),n("span",{class:"token punctuation"},"("),n("span",{class:"token punctuation"},")"),n("span",{class:"token punctuation"},";"),s(`

`),n("span",{class:"token comment"},"// 声明交换机，指定交换机类型为 fanout"),s(`
channel`),n("span",{class:"token punctuation"},"."),n("span",{class:"token function"},"ExchangeDeclare"),n("span",{class:"token punctuation"},"("),s(`
    `),n("span",{class:"token named-parameter punctuation"},"exchange"),n("span",{class:"token punctuation"},":"),s(),n("span",{class:"token string"},'"logs"'),n("span",{class:"token punctuation"},","),s(`
    `),n("span",{class:"token named-parameter punctuation"},"type"),n("span",{class:"token punctuation"},":"),s(" ExchangeType"),n("span",{class:"token punctuation"},"."),s("Fanout"),n("span",{class:"token punctuation"},")"),n("span",{class:"token punctuation"},";"),s(`

`),n("span",{class:"token comment"},"// 声明队列，让系统随机生成队列名"),s(`
`),n("span",{class:"token comment"},"// 当我们不向 QueueDeclare（） 提供任何参数时，我们会创建一个具有生成名称的非持久、独占、自动删除队列："),s(`
`),n("span",{class:"token class-name"},[n("span",{class:"token keyword"},"var")]),s(" queueName "),n("span",{class:"token operator"},"="),s(" channel"),n("span",{class:"token punctuation"},"."),n("span",{class:"token function"},"QueueDeclare"),n("span",{class:"token punctuation"},"("),n("span",{class:"token punctuation"},")"),n("span",{class:"token punctuation"},"."),s("QueueName"),n("span",{class:"token punctuation"},";"),s(`

`),n("span",{class:"token comment"},"// 将队列绑定到交换机"),s(`
channel`),n("span",{class:"token punctuation"},"."),n("span",{class:"token function"},"QueueBind"),n("span",{class:"token punctuation"},"("),s(`
    `),n("span",{class:"token named-parameter punctuation"},"queue"),n("span",{class:"token punctuation"},":"),s(" queueName"),n("span",{class:"token punctuation"},","),s("  "),n("span",{class:"token comment"},"// 队列名称"),s(`
    exchange`),n("span",{class:"token punctuation"},":"),s(),n("span",{class:"token string"},'"logs"'),n("span",{class:"token punctuation"},","),s("  "),n("span",{class:"token comment"},"// 交换机名称"),s(`
    routingKey`),n("span",{class:"token punctuation"},":"),s(),n("span",{class:"token string"},'""'),n("span",{class:"token punctuation"},")"),n("span",{class:"token punctuation"},";"),s("   "),n("span",{class:"token comment"},"// 发送到 fanout 类型的交换机时，routingKey 不起作用，可以设置为空字符串"),s(`

Console`),n("span",{class:"token punctuation"},"."),n("span",{class:"token function"},"WriteLine"),n("span",{class:"token punctuation"},"("),n("span",{class:"token string"},'" [消费者1] 等待消息中..."'),n("span",{class:"token punctuation"},")"),n("span",{class:"token punctuation"},";"),s(`

`),n("span",{class:"token comment"},"// 创建事件消费者，用于处理接收到的消息"),s(`
`),n("span",{class:"token class-name"},[n("span",{class:"token keyword"},"var")]),s(" consumer "),n("span",{class:"token operator"},"="),s(),n("span",{class:"token keyword"},"new"),s(),n("span",{class:"token constructor-invocation class-name"},"EventingBasicConsumer"),n("span",{class:"token punctuation"},"("),s("channel"),n("span",{class:"token punctuation"},")"),n("span",{class:"token punctuation"},";"),s(`

`),n("span",{class:"token comment"},"// 处理接收到的消息"),s(`
consumer`),n("span",{class:"token punctuation"},"."),s("Received "),n("span",{class:"token operator"},"+="),s(),n("span",{class:"token punctuation"},"("),s("model"),n("span",{class:"token punctuation"},","),s(" ea"),n("span",{class:"token punctuation"},")"),s(),n("span",{class:"token operator"},"=>"),s(`
`),n("span",{class:"token punctuation"},"{"),s(`
    `),n("span",{class:"token class-name"},[s("ReadOnlyMemory"),n("span",{class:"token punctuation"},"<"),n("span",{class:"token keyword"},"byte"),n("span",{class:"token punctuation"},">")]),s(" body "),n("span",{class:"token operator"},"="),s(" ea"),n("span",{class:"token punctuation"},"."),s("Body"),n("span",{class:"token punctuation"},"."),n("span",{class:"token function"},"ToArray"),n("span",{class:"token punctuation"},"("),n("span",{class:"token punctuation"},")"),n("span",{class:"token punctuation"},";"),s(`
    `),n("span",{class:"token class-name"},[n("span",{class:"token keyword"},"string")]),s(" message "),n("span",{class:"token operator"},"="),s(" Encoding"),n("span",{class:"token punctuation"},"."),s("UTF8"),n("span",{class:"token punctuation"},"."),n("span",{class:"token function"},"GetString"),n("span",{class:"token punctuation"},"("),s("body"),n("span",{class:"token punctuation"},"."),s("Span"),n("span",{class:"token punctuation"},")"),n("span",{class:"token punctuation"},";"),s(`
    Console`),n("span",{class:"token punctuation"},"."),n("span",{class:"token function"},"WriteLine"),n("span",{class:"token punctuation"},"("),n("span",{class:"token string"},'" [消费者1] 收到消息：{0}"'),n("span",{class:"token punctuation"},","),s(" message"),n("span",{class:"token punctuation"},")"),n("span",{class:"token punctuation"},";"),s(`
`),n("span",{class:"token punctuation"},"}"),n("span",{class:"token punctuation"},";"),s(`

`),n("span",{class:"token comment"},"// 订阅队列"),s(`
channel`),n("span",{class:"token punctuation"},"."),n("span",{class:"token function"},"BasicConsume"),n("span",{class:"token punctuation"},"("),s(`
    `),n("span",{class:"token named-parameter punctuation"},"queue"),n("span",{class:"token punctuation"},":"),s(" queueName"),n("span",{class:"token punctuation"},","),s("  "),n("span",{class:"token comment"},"// 队列名称"),s(`
    autoAck`),n("span",{class:"token punctuation"},":"),s(),n("span",{class:"token boolean"},"true"),n("span",{class:"token punctuation"},","),s("     "),n("span",{class:"token comment"},"// 是否自动发送确认消息"),s(`
    consumer`),n("span",{class:"token punctuation"},":"),s(" consumer"),n("span",{class:"token punctuation"},")"),n("span",{class:"token punctuation"},";"),s(`

Console`),n("span",{class:"token punctuation"},"."),n("span",{class:"token function"},"WriteLine"),n("span",{class:"token punctuation"},"("),n("span",{class:"token string"},'"按[Enter]键退出"'),n("span",{class:"token punctuation"},")"),n("span",{class:"token punctuation"},";"),s(`
Console`),n("span",{class:"token punctuation"},"."),n("span",{class:"token function"},"ReadLine"),n("span",{class:"token punctuation"},"("),n("span",{class:"token punctuation"},")"),n("span",{class:"token punctuation"},";"),s(`
`)])]),n("div",{class:"line-numbers","aria-hidden":"true"},[n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"})])],-1),y=n("div",{class:"language-csharp line-numbers-mode","data-ext":"cs"},[n("pre",{class:"language-csharp"},[n("code",null,[n("span",{class:"token keyword"},"using"),s(),n("span",{class:"token namespace"},[s("RabbitMQ"),n("span",{class:"token punctuation"},"."),s("Client"),n("span",{class:"token punctuation"},"."),s("Events")]),n("span",{class:"token punctuation"},";"),s(`
`),n("span",{class:"token keyword"},"using"),s(),n("span",{class:"token namespace"},[s("RabbitMQ"),n("span",{class:"token punctuation"},"."),s("Client")]),n("span",{class:"token punctuation"},";"),s(`
`),n("span",{class:"token keyword"},"using"),s(),n("span",{class:"token namespace"},[s("System"),n("span",{class:"token punctuation"},"."),s("Text")]),n("span",{class:"token punctuation"},";"),s(`

`),n("span",{class:"token comment"},"// 创建连接工厂对象，指定主机名和登录凭据信息"),s(`
`),n("span",{class:"token class-name"},"ConnectionFactory"),s(" factory "),n("span",{class:"token operator"},"="),s(),n("span",{class:"token keyword"},"new"),n("span",{class:"token punctuation"},"("),n("span",{class:"token punctuation"},")"),s(`
`),n("span",{class:"token punctuation"},"{"),s(`
    HostName `),n("span",{class:"token operator"},"="),s(),n("span",{class:"token string"},'"192.168.3.100"'),n("span",{class:"token punctuation"},","),s(`
    Port `),n("span",{class:"token operator"},"="),s(),n("span",{class:"token number"},"5672"),n("span",{class:"token punctuation"},","),s(`
    UserName `),n("span",{class:"token operator"},"="),s(),n("span",{class:"token string"},'"guest"'),n("span",{class:"token punctuation"},","),s(`
    Password `),n("span",{class:"token operator"},"="),s(),n("span",{class:"token string"},'"guest"'),s(`
`),n("span",{class:"token punctuation"},"}"),n("span",{class:"token punctuation"},";"),s(`
`),n("span",{class:"token comment"},"// 创建连接和通道"),s(`
`),n("span",{class:"token keyword"},"using"),s(),n("span",{class:"token class-name"},[n("span",{class:"token keyword"},"var")]),s(" connection "),n("span",{class:"token operator"},"="),s(" factory"),n("span",{class:"token punctuation"},"."),n("span",{class:"token function"},"CreateConnection"),n("span",{class:"token punctuation"},"("),n("span",{class:"token punctuation"},")"),n("span",{class:"token punctuation"},";"),s(`
`),n("span",{class:"token keyword"},"using"),s(),n("span",{class:"token class-name"},[n("span",{class:"token keyword"},"var")]),s(" channel "),n("span",{class:"token operator"},"="),s(" connection"),n("span",{class:"token punctuation"},"."),n("span",{class:"token function"},"CreateModel"),n("span",{class:"token punctuation"},"("),n("span",{class:"token punctuation"},")"),n("span",{class:"token punctuation"},";"),s(`

`),n("span",{class:"token comment"},"// 声明交换机，指定交换机类型为 fanout"),s(`
channel`),n("span",{class:"token punctuation"},"."),n("span",{class:"token function"},"ExchangeDeclare"),n("span",{class:"token punctuation"},"("),s(`
    `),n("span",{class:"token named-parameter punctuation"},"exchange"),n("span",{class:"token punctuation"},":"),s(),n("span",{class:"token string"},'"logs"'),n("span",{class:"token punctuation"},","),s(`
    `),n("span",{class:"token named-parameter punctuation"},"type"),n("span",{class:"token punctuation"},":"),s(" ExchangeType"),n("span",{class:"token punctuation"},"."),s("Fanout"),n("span",{class:"token punctuation"},")"),n("span",{class:"token punctuation"},";"),s(`

`),n("span",{class:"token comment"},"// 声明队列，让系统随机生成队列名"),s(`
`),n("span",{class:"token comment"},"// 当我们不向 QueueDeclare（） 提供任何参数时，我们会创建一个具有生成名称的非持久、独占、自动删除队列："),s(`
`),n("span",{class:"token class-name"},[n("span",{class:"token keyword"},"var")]),s(" queueName "),n("span",{class:"token operator"},"="),s(" channel"),n("span",{class:"token punctuation"},"."),n("span",{class:"token function"},"QueueDeclare"),n("span",{class:"token punctuation"},"("),n("span",{class:"token punctuation"},")"),n("span",{class:"token punctuation"},"."),s("QueueName"),n("span",{class:"token punctuation"},";"),s(`

`),n("span",{class:"token comment"},"// 将队列绑定到交换机"),s(`
channel`),n("span",{class:"token punctuation"},"."),n("span",{class:"token function"},"QueueBind"),n("span",{class:"token punctuation"},"("),s(`
    `),n("span",{class:"token named-parameter punctuation"},"queue"),n("span",{class:"token punctuation"},":"),s(" queueName"),n("span",{class:"token punctuation"},","),s("  "),n("span",{class:"token comment"},"// 队列名称"),s(`
    exchange`),n("span",{class:"token punctuation"},":"),s(),n("span",{class:"token string"},'"logs"'),n("span",{class:"token punctuation"},","),s("  "),n("span",{class:"token comment"},"// 交换机名称"),s(`
    routingKey`),n("span",{class:"token punctuation"},":"),s(),n("span",{class:"token string"},'""'),n("span",{class:"token punctuation"},")"),n("span",{class:"token punctuation"},";"),s("   "),n("span",{class:"token comment"},"// 发送到 fanout 类型的交换机时，routingKey 不起作用，可以设置为空字符串"),s(`

Console`),n("span",{class:"token punctuation"},"."),n("span",{class:"token function"},"WriteLine"),n("span",{class:"token punctuation"},"("),n("span",{class:"token string"},'" [消费者2] 等待消息中..."'),n("span",{class:"token punctuation"},")"),n("span",{class:"token punctuation"},";"),s(`

`),n("span",{class:"token comment"},"// 创建事件消费者，用于处理接收到的消息"),s(`
`),n("span",{class:"token class-name"},[n("span",{class:"token keyword"},"var")]),s(" consumer "),n("span",{class:"token operator"},"="),s(),n("span",{class:"token keyword"},"new"),s(),n("span",{class:"token constructor-invocation class-name"},"EventingBasicConsumer"),n("span",{class:"token punctuation"},"("),s("channel"),n("span",{class:"token punctuation"},")"),n("span",{class:"token punctuation"},";"),s(`

`),n("span",{class:"token comment"},"// 处理接收到的消息"),s(`
consumer`),n("span",{class:"token punctuation"},"."),s("Received "),n("span",{class:"token operator"},"+="),s(),n("span",{class:"token punctuation"},"("),s("model"),n("span",{class:"token punctuation"},","),s(" ea"),n("span",{class:"token punctuation"},")"),s(),n("span",{class:"token operator"},"=>"),s(`
`),n("span",{class:"token punctuation"},"{"),s(`
    `),n("span",{class:"token class-name"},[s("ReadOnlyMemory"),n("span",{class:"token punctuation"},"<"),n("span",{class:"token keyword"},"byte"),n("span",{class:"token punctuation"},">")]),s(" body "),n("span",{class:"token operator"},"="),s(" ea"),n("span",{class:"token punctuation"},"."),s("Body"),n("span",{class:"token punctuation"},"."),n("span",{class:"token function"},"ToArray"),n("span",{class:"token punctuation"},"("),n("span",{class:"token punctuation"},")"),n("span",{class:"token punctuation"},";"),s(`
    `),n("span",{class:"token class-name"},[n("span",{class:"token keyword"},"string")]),s(" message "),n("span",{class:"token operator"},"="),s(" Encoding"),n("span",{class:"token punctuation"},"."),s("UTF8"),n("span",{class:"token punctuation"},"."),n("span",{class:"token function"},"GetString"),n("span",{class:"token punctuation"},"("),s("body"),n("span",{class:"token punctuation"},"."),s("Span"),n("span",{class:"token punctuation"},")"),n("span",{class:"token punctuation"},";"),s(`
    Console`),n("span",{class:"token punctuation"},"."),n("span",{class:"token function"},"WriteLine"),n("span",{class:"token punctuation"},"("),n("span",{class:"token string"},'" [消费者2] 收到消息：{0}"'),n("span",{class:"token punctuation"},","),s(" message"),n("span",{class:"token punctuation"},")"),n("span",{class:"token punctuation"},";"),s(`
`),n("span",{class:"token punctuation"},"}"),n("span",{class:"token punctuation"},";"),s(`

`),n("span",{class:"token comment"},"// 订阅队列"),s(`
channel`),n("span",{class:"token punctuation"},"."),n("span",{class:"token function"},"BasicConsume"),n("span",{class:"token punctuation"},"("),s(`
    `),n("span",{class:"token named-parameter punctuation"},"queue"),n("span",{class:"token punctuation"},":"),s(" queueName"),n("span",{class:"token punctuation"},","),s("  "),n("span",{class:"token comment"},"// 队列名称"),s(`
    autoAck`),n("span",{class:"token punctuation"},":"),s(),n("span",{class:"token boolean"},"true"),n("span",{class:"token punctuation"},","),s("     "),n("span",{class:"token comment"},"// 是否自动发送确认消息"),s(`
    consumer`),n("span",{class:"token punctuation"},":"),s(" consumer"),n("span",{class:"token punctuation"},")"),n("span",{class:"token punctuation"},";"),s(`

Console`),n("span",{class:"token punctuation"},"."),n("span",{class:"token function"},"WriteLine"),n("span",{class:"token punctuation"},"("),n("span",{class:"token string"},'"按[Enter]键退出"'),n("span",{class:"token punctuation"},")"),n("span",{class:"token punctuation"},";"),s(`
Console`),n("span",{class:"token punctuation"},"."),n("span",{class:"token function"},"ReadLine"),n("span",{class:"token punctuation"},"("),n("span",{class:"token punctuation"},")"),n("span",{class:"token punctuation"},";"),s(`
`)])]),n("div",{class:"line-numbers","aria-hidden":"true"},[n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"})])],-1),f=n("p",null,"分别启动消费者及生产者客户端，得到如下输出：",-1),w=n("div",{class:"language-bash line-numbers-mode","data-ext":"sh"},[n("pre",{class:"language-bash"},[n("code",null,[n("span",{class:"token punctuation"},"["),s("生产者"),n("span",{class:"token punctuation"},"]"),s(" 发送消息：Log 消息 "),n("span",{class:"token number"},"0"),s(`
`),n("span",{class:"token punctuation"},"["),s("生产者"),n("span",{class:"token punctuation"},"]"),s(" 发送消息：Log 消息 "),n("span",{class:"token number"},"1"),s(`
`),n("span",{class:"token punctuation"},"["),s("生产者"),n("span",{class:"token punctuation"},"]"),s(" 发送消息：Log 消息 "),n("span",{class:"token number"},"2"),s(`
`),n("span",{class:"token punctuation"},"["),s("生产者"),n("span",{class:"token punctuation"},"]"),s(" 发送消息：Log 消息 "),n("span",{class:"token number"},"3"),s(`
`),n("span",{class:"token punctuation"},"["),s("生产者"),n("span",{class:"token punctuation"},"]"),s(" 发送消息：Log 消息 "),n("span",{class:"token number"},"4"),s(`
`),n("span",{class:"token punctuation"},"["),s("生产者"),n("span",{class:"token punctuation"},"]"),s(" 发送消息：Log 消息 "),n("span",{class:"token number"},"5"),s(`
`),n("span",{class:"token punctuation"},"["),s("生产者"),n("span",{class:"token punctuation"},"]"),s(" 发送消息：Log 消息 "),n("span",{class:"token number"},"6"),s(`
`),n("span",{class:"token punctuation"},"["),s("生产者"),n("span",{class:"token punctuation"},"]"),s(" 发送消息：Log 消息 "),n("span",{class:"token number"},"7"),s(`
`),n("span",{class:"token punctuation"},"["),s("生产者"),n("span",{class:"token punctuation"},"]"),s(" 发送消息：Log 消息 "),n("span",{class:"token number"},"8"),s(`
`),n("span",{class:"token punctuation"},"["),s("生产者"),n("span",{class:"token punctuation"},"]"),s(" 发送消息：Log 消息 "),n("span",{class:"token number"},"9"),s(`
按`),n("span",{class:"token punctuation"},"["),s("Enter"),n("span",{class:"token punctuation"},"]"),s(`键退出
`)])]),n("div",{class:"line-numbers","aria-hidden":"true"},[n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"})])],-1),L=n("div",{class:"language-bash line-numbers-mode","data-ext":"sh"},[n("pre",{class:"language-bash"},[n("code",null,[n("span",{class:"token punctuation"},"["),s("消费者1"),n("span",{class:"token punctuation"},"]"),s(" 等待消息中"),n("span",{class:"token punctuation"},".."),s(`.
按`),n("span",{class:"token punctuation"},"["),s("Enter"),n("span",{class:"token punctuation"},"]"),s(`键退出
`),n("span",{class:"token punctuation"},"["),s("消费者1"),n("span",{class:"token punctuation"},"]"),s(" 收到消息：Log 消息 "),n("span",{class:"token number"},"0"),s(`
`),n("span",{class:"token punctuation"},"["),s("消费者1"),n("span",{class:"token punctuation"},"]"),s(" 收到消息：Log 消息 "),n("span",{class:"token number"},"1"),s(`
`),n("span",{class:"token punctuation"},"["),s("消费者1"),n("span",{class:"token punctuation"},"]"),s(" 收到消息：Log 消息 "),n("span",{class:"token number"},"2"),s(`
`),n("span",{class:"token punctuation"},"["),s("消费者1"),n("span",{class:"token punctuation"},"]"),s(" 收到消息：Log 消息 "),n("span",{class:"token number"},"3"),s(`
`),n("span",{class:"token punctuation"},"["),s("消费者1"),n("span",{class:"token punctuation"},"]"),s(" 收到消息：Log 消息 "),n("span",{class:"token number"},"4"),s(`
`),n("span",{class:"token punctuation"},"["),s("消费者1"),n("span",{class:"token punctuation"},"]"),s(" 收到消息：Log 消息 "),n("span",{class:"token number"},"5"),s(`
`),n("span",{class:"token punctuation"},"["),s("消费者1"),n("span",{class:"token punctuation"},"]"),s(" 收到消息：Log 消息 "),n("span",{class:"token number"},"6"),s(`
`),n("span",{class:"token punctuation"},"["),s("消费者1"),n("span",{class:"token punctuation"},"]"),s(" 收到消息：Log 消息 "),n("span",{class:"token number"},"7"),s(`
`),n("span",{class:"token punctuation"},"["),s("消费者1"),n("span",{class:"token punctuation"},"]"),s(" 收到消息：Log 消息 "),n("span",{class:"token number"},"8"),s(`
`),n("span",{class:"token punctuation"},"["),s("消费者1"),n("span",{class:"token punctuation"},"]"),s(" 收到消息：Log 消息 "),n("span",{class:"token number"},"9"),s(`
`)])]),n("div",{class:"line-numbers","aria-hidden":"true"},[n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"})])],-1),_=n("div",{class:"language-bash line-numbers-mode","data-ext":"sh"},[n("pre",{class:"language-bash"},[n("code",null,[n("span",{class:"token punctuation"},"["),s("消费者2"),n("span",{class:"token punctuation"},"]"),s(" 等待消息中"),n("span",{class:"token punctuation"},".."),s(`.
按`),n("span",{class:"token punctuation"},"["),s("Enter"),n("span",{class:"token punctuation"},"]"),s(`键退出
`),n("span",{class:"token punctuation"},"["),s("消费者2"),n("span",{class:"token punctuation"},"]"),s(" 收到消息：Log 消息 "),n("span",{class:"token number"},"0"),s(`
`),n("span",{class:"token punctuation"},"["),s("消费者2"),n("span",{class:"token punctuation"},"]"),s(" 收到消息：Log 消息 "),n("span",{class:"token number"},"1"),s(`
`),n("span",{class:"token punctuation"},"["),s("消费者2"),n("span",{class:"token punctuation"},"]"),s(" 收到消息：Log 消息 "),n("span",{class:"token number"},"2"),s(`
`),n("span",{class:"token punctuation"},"["),s("消费者2"),n("span",{class:"token punctuation"},"]"),s(" 收到消息：Log 消息 "),n("span",{class:"token number"},"3"),s(`
`),n("span",{class:"token punctuation"},"["),s("消费者2"),n("span",{class:"token punctuation"},"]"),s(" 收到消息：Log 消息 "),n("span",{class:"token number"},"4"),s(`
`),n("span",{class:"token punctuation"},"["),s("消费者2"),n("span",{class:"token punctuation"},"]"),s(" 收到消息：Log 消息 "),n("span",{class:"token number"},"5"),s(`
`),n("span",{class:"token punctuation"},"["),s("消费者2"),n("span",{class:"token punctuation"},"]"),s(" 收到消息：Log 消息 "),n("span",{class:"token number"},"6"),s(`
`),n("span",{class:"token punctuation"},"["),s("消费者2"),n("span",{class:"token punctuation"},"]"),s(" 收到消息：Log 消息 "),n("span",{class:"token number"},"7"),s(`
`),n("span",{class:"token punctuation"},"["),s("消费者2"),n("span",{class:"token punctuation"},"]"),s(" 收到消息：Log 消息 "),n("span",{class:"token number"},"8"),s(`
`),n("span",{class:"token punctuation"},"["),s("消费者2"),n("span",{class:"token punctuation"},"]"),s(" 收到消息：Log 消息 "),n("span",{class:"token number"},"9"),s(`
`)])]),n("div",{class:"line-numbers","aria-hidden":"true"},[n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"})])],-1),x=n("p",null,"从输出结果中我们可以看到，生产者发出的消息被所有订阅者收到。",-1);function C(E,N){const c=u("Tabs");return p(),i("div",null,[b,k(" more "),v,o(c,{id:"55",data:[{id:"生产者"},{id:"消费者1"},{id:"消费者2"}]},{title0:a(({value:t,isActive:e})=>[s("生产者")]),title1:a(({value:t,isActive:e})=>[s("消费者1")]),title2:a(({value:t,isActive:e})=>[s("消费者2")]),tab0:a(({value:t,isActive:e})=>[g]),tab1:a(({value:t,isActive:e})=>[h]),tab2:a(({value:t,isActive:e})=>[y]),_:1}),f,o(c,{id:"69",data:[{id:"生产者"},{id:"消费者1"},{id:"消费者2"}]},{title0:a(({value:t,isActive:e})=>[s("生产者")]),title1:a(({value:t,isActive:e})=>[s("消费者1")]),title2:a(({value:t,isActive:e})=>[s("消费者2")]),tab0:a(({value:t,isActive:e})=>[w]),tab1:a(({value:t,isActive:e})=>[L]),tab2:a(({value:t,isActive:e})=>[_]),_:1}),x])}const Q=l(d,[["render",C],["__file","publish-subscribe-mode.html.vue"]]);export{Q as default};
